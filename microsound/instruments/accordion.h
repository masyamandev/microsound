/*
 * Author: Aleksandr Maksymenko aka masyaman
 */

const int8_t accordionWaveTable[] PROGMEM = {
		0, 5, 11, 11, 10, 10, 14, 18, 22, 24, 26, 29, 30, 32, 34, 34,
		34, 33, 33, 33, 33, 32, 31, 30, 30, 29, 29, 29, 29, 29, 30, 32,
		33, 37, 40, 44, 48, 52, 56, 62, 69, 75, 82, 90, 97, 105, 112, 119,
		122, 124, 127, 126, 125, 124, 121, 119, 116, 112, 107, 102, 96, 91, 85, 79,
		72, 66, 61, 56, 51, 48, 45, 41, 40, 40, 39, 39, 40, 41, 41, 42,
		43, 43, 43, 44, 43, 42, 40, 39, 37, 35, 32, 28, 25, 22, 19, 17,
		16, 15, 14, 15, 15, 16, 18, 21, 24, 26, 27, 29, 29, 29, 29, 29,
		30, 31, 33, 34, 35, 36, 37, 38, 38, 37, 37, 37, 37, 38, 38, 39,
		40, 40, 39, 38, 37, 36, 34, 32, 30, 28, 25, 22, 18, 15, 10, 6,
		2, -3, -9, -15, -21, -27, -34, -41, -47, -53, -58, -62, -66, -69, -72, -75,
		-79, -83, -86, -87, -89, -90, -90, -90, -89, -86, -84, -82, -80, -78, -77, -75,
		-73, -72, -72, -72, -72, -73, -74, -75, -76, -77, -79, -81, -83, -86, -88, -91,
		-94, -95, -97, -97, -96, -94, -92, -89, -86, -83, -78, -74, -69, -65, -61, -57,
		-55, -52, -49, -48, -47, -46, -46, -47, -48, -49, -51, -52, -54, -57, -59, -58,
		-57, -55, -51, -46, -42, -40, -38, -36, -35, -34, -33, -33, -33, -33, -33, -34,
		-35, -34, -33, -33, -31, -29, -27, -26, -25, -24, -22, -20, -18, -14, -10, -6
		};

const uint8_t accordionVolumeTable[] PROGMEM = {
		6, 14, 24, 40, 58, 81, 100, 124, 148, 177, 187, 186, 189, 193, 206, 215,
		213, 211, 209, 217, 235, 225, 223, 227, 232, 240, 238, 233, 230, 233, 245, 232};

void playAccordion(waveChannel* channel, uint8_t data) {
	channel->waveStep = pgm_read_word(&frequencies[data]);
	channel->waveForm = accordionWaveTable;

	channel->volumeForm = accordionVolumeTable;
	channel->volumeFormLength = 32 - 1;
	channel->volumeTicksPerSample = 1;
	channel->volumeTicksCounter = 1;

	channel->currentVolume = 0;
}
